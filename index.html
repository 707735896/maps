<!DOCTYPE html>
<html lang="en">

	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="initial-scale=1.0, user-scalable=no, width=device-width">
		<title>智能铁鞋定位管理系统</title>
		<link rel="stylesheet" href="http://cache.amap.com/lbs/static/main1119.css" />
		<link rel="stylesheet" type="text/css" href="css/antd.min.css" />
		<link rel="stylesheet" type="text/css" href="css/public.css" />
		<script src="js/jquery-1.11.2.min.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript" src="http://webapi.amap.com/maps?v=1.4.6&key=039d9eb6679bf645545be910b8701a69&plugin=AMap.Geocoder"></script>
	</head>

	<body>
		<div class="header-left">
			<div class="header-left-name">
				<img src="img/logo.png" width="25" height="25" style="vertical-align: middle;" />
				<span>智能铁鞋定位管理系统</span>
			</div>
			<div class="header-right">admin<i id="quit" class="anticon anticon-poweroff" style="padding: 5px 0px 5px 15px; cursor: pointer;"><svg viewBox="64 64 896 896" class="" data-icon="poweroff" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M705.6 124.9a8 8 0 0 0-11.6 7.2v64.2c0 5.5 2.9 10.6 7.5 13.6a352.2 352.2 0 0 1 62.2 49.8c32.7 32.8 58.4 70.9 76.3 113.3a355 355 0 0 1 27.9 138.7c0 48.1-9.4 94.8-27.9 138.7a355.92 355.92 0 0 1-76.3 113.3 353.06 353.06 0 0 1-113.2 76.4c-43.8 18.6-90.5 28-138.5 28s-94.7-9.4-138.5-28a353.06 353.06 0 0 1-113.2-76.4A355.92 355.92 0 0 1 184 650.4a355 355 0 0 1-27.9-138.7c0-48.1 9.4-94.8 27.9-138.7 17.9-42.4 43.6-80.5 76.3-113.3 19-19 39.8-35.6 62.2-49.8 4.7-2.9 7.5-8.1 7.5-13.6V132c0-6-6.3-9.8-11.6-7.2C178.5 195.2 82 339.3 80 506.3 77.2 745.1 272.5 943.5 511.2 944c239 .5 432.8-193.3 432.8-432.4 0-169.2-97-315.7-238.4-386.7zM480 560h64c4.4 0 8-3.6 8-8V88c0-4.4-3.6-8-8-8h-64c-4.4 0-8 3.6-8 8v464c0 4.4 3.6 8 8 8z"></path></svg></i></div>
		</div>
		<div id="container" style="top: 50px;"></div>
		<div class="close-icon">
			<i class="anticon anticon-double-right"><svg viewBox="64 64 896 896" class="" data-icon="double-right" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M533.2 492.3L277.9 166.1c-3-3.9-7.7-6.1-12.6-6.1H188c-6.7 0-10.4 7.7-6.3 12.9L447.1 512 181.7 851.1A7.98 7.98 0 0 0 188 864h77.3c4.9 0 9.6-2.3 12.6-6.1l255.3-326.1c9.1-11.7 9.1-27.9 0-39.5zm304 0L581.9 166.1c-3-3.9-7.7-6.1-12.6-6.1H492c-6.7 0-10.4 7.7-6.3 12.9L751.1 512 485.7 851.1A7.98 7.98 0 0 0 492 864h77.3c4.9 0 9.6-2.3 12.6-6.1l255.3-326.1c9.1-11.7 9.1-27.9 0-39.5z"></path></svg></i>
		</div>
		<div class="show-icon">
			<i class="anticon anticon-double-left"><svg viewBox="64 64 896 896" class="" data-icon="double-left" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M272.9 512l265.4-339.1c4.1-5.2.4-12.9-6.3-12.9h-77.3c-4.9 0-9.6 2.3-12.6 6.1L186.8 492.3a31.99 31.99 0 0 0 0 39.5l255.3 326.1c3 3.9 7.7 6.1 12.6 6.1H532c6.7 0 10.4-7.7 6.3-12.9L272.9 512zm304 0l265.4-339.1c4.1-5.2.4-12.9-6.3-12.9h-77.3c-4.9 0-9.6 2.3-12.6 6.1L490.8 492.3a31.99 31.99 0 0 0 0 39.5l255.3 326.1c3 3.9 7.7 6.1 12.6 6.1H836c6.7 0 10.4-7.7 6.3-12.9L576.9 512z"></path></svg></i>
		</div>
		<div class="infoList">
			<div>
				<span class="ant-input-search ant-input-search-enter-button ant-input-affix-wrapper"><input placeholder="输入名称或IMEI" class="ant-input" type="text"><span class="ant-input-suffix"><button id="search" type="button" class="ant-btn ant-input-search-button ant-btn-primary"><span>搜 索</span></button</span>
				</span>
			</div>
			<div style="margin: 5px 0px; background-color: rgb(197, 197, 197); height: 0px; width: 100%;"></div>
			<div class="btn-group" role="group" style="width: 100%; margin: 0px; background-color: rgb(232, 232, 232);"><button id="all" type="button" class="btn btn-default btn-sm btn-tab-activity" style="width: 33.33%;">全部(10)</button><button id="onLine" type="button" class="btn btn-default btn-sm" style="width: 33.33%;">在线(0)</button><button id="offLine" type="button" class="btn btn-default btn-sm" style="width: 33.33%;">离线(10)</button></div>
			<div class="getList" id="getList">
			</div>
		</div>
		<script src="//webapi.amap.com/ui/1.0/main.js?v=1.0.11"></script>
		<script type="text/javascript">
			//创建地图
			var map = new AMap.Map('container', {
				zoom: 9
			});

			var lnglatXY;

			//构建数据源，数据项本身没有格式要求，但需要支持getDataId和getPosition
			var arr = [{
				bootid: '363620181216243',
				bootname: '板鞋',
				stationid: '铁鞋所在站id',
				bootdeviceid: '铁鞋设备id',
				onlinestate: 0,
				uploadmode: 'WIFI',
				batteryvoumn: '95%',
				signalintensity: 1,
				updatetime: '2019-03-17 17:17:53',
				position: [120.618139, 31.300408],
				address:'苏州吴中区。'
			}, {
				bootid: '363620181216243',
				bootname: '球鞋',
				stationid: '铁鞋所在站id',
				bootdeviceid: '铁鞋设备id',
				onlinestate: 1,
				uploadmode: 'WIFI',
				batteryvoumn: '95%',
				signalintensity: 2,
				updatetime: '2019-03-17 17:17:53',
				position: [120.616897, 31.300689],
			}, {
				bootid: '363620181216243',
				bootname: '草鞋',
				stationid: '铁鞋所在站id',
				bootdeviceid: '铁鞋设备id',
				onlinestate: 0,
				uploadmode: 'WIFI',
				batteryvoumn: '95%',
				signalintensity: 3,
				updatetime: '2019-03-17 17:17:53',
				position: [120.616228, 31.301633],
			}, {
				bootid: '363620181216243',
				bootname: '拖鞋',
				stationid: '铁鞋所在站id',
				bootdeviceid: '铁鞋设备id',
				onlinestate: 1,
				uploadmode: 'WIFI',
				batteryvoumn: '95%',
				signalintensity: 5,
				updatetime: '2019-03-17 17:17:53',
				position: [120.616237, 31.30232],
			}, {
				bootid: '363620181216243',
				bootname: '高跟鞋',
				stationid: '铁鞋所在站id',
				bootdeviceid: '铁鞋设备id',
				onlinestate: 1,
				uploadmode: 'WIFI',
				batteryvoumn: '95%',
				signalintensity: 2,
				updatetime: '2019-03-17 17:17:53',
				position: [120.616188, 31.302815],
			}, {
				bootid: '3636201812162431',
				bootname: '增高鞋',
				stationid: '铁鞋所在站id',
				bootdeviceid: '铁鞋设备id',
				onlinestate: 0,
				uploadmode: 'WIFI',
				batteryvoumn: '95%',
				signalintensity: 4,
				updatetime: '2019-03-17 17:17:53',
				position: [120.61567, 31.302494],
			}, {
				bootid: '3636201812162431',
				bootname: '布鞋',
				stationid: '铁鞋所在站id',
				bootdeviceid: '铁鞋设备id',
				onlinestate: 1,
				uploadmode: 'WIFI',
				batteryvoumn: '95%',
				signalintensity: 1,
				updatetime: '2019-03-17 17:17:53',
				position: [120.615276, 31.301696],
			}, {
				bootid: '1363620181216243',
				bootname: '帆布鞋',
				stationid: '铁鞋所在站id',
				bootdeviceid: '铁鞋设备id',
				onlinestate: 1,
				uploadmode: 'WIFI',
				batteryvoumn: '95%',
				signalintensity: 3,
				updatetime: '2019-03-17 17:17:53',
				position: [120.615171, 31.300674],
			}];
			transform(arr);

			function transform(arr) {
				$.each(arr, function(n, value) {
					if(value.signalintensity == 1) {
						value.signalintensity = 'img/Signal-1.png'
					}
					if(value.signalintensity == 2) {
						value.signalintensity = 'img/Signal-2.png'
					}
					if(value.signalintensity == 3) {
						value.signalintensity = 'img/Signal-3.png'
					}
					if(value.signalintensity == 4) {
						value.signalintensity = 'img/Signal-4.png'
					}
					if(value.signalintensity == 5) {
						value.signalintensity = 'img/Signal-5.png'
					}

					if(value.onlinestate == 0) {
						value.onlinestate = '离线';
					}

					if(value.onlinestate == 1) {
						value.onlinestate = '在线';
					}

					var geocoder = new AMap.Geocoder({
						radius: 1000,
						extensions: "all"
					});
					geocoder.getAddress(value.position, function(status, result) {
						if(status === 'complete' && result.info === 'OK') {
							value.address = result.regeocode.formattedAddress;
						}
					});

				});
			}

			//加载MarkerList，loadUI的路径参数为模块名中 'ui/' 之后的部分    
			AMapUI.loadUI(['misc/MarkerList'], function(MarkerList) {
				//启动页面
				initPage(MarkerList);
			});

			function initPage(MarkerList) {
				//创建一个实例
				var markerList = new MarkerList({
					//关联的map对象
					map: map,
					//列表的dom容器的节点或者id, 用于放置getListElement返回的内容
					listContainer: 'getList',
					//选中状态（通过点击列表或者marker）时在Marker和列表节点上添加的class，可以借此编写css控制选中时的展示效果
					selectedClassNames: 'my-active',
					//需要监听的列表节点事件
					listElementEvents: ['click', 'mouseenter', 'mouseleave'],
					//需要监听的marker事件
					markerEvents: ['click', 'mouseover', 'mouseout'],
					getDataId: function(dataItem, index) {
						//返回数据项的Id
						return dataItem.id;
					},
					getPosition: function(dataItem) {
						//返回数据项的经纬度，AMap.LngLat实例或者经纬度数组
						return dataItem.position;
					},
					getMarker: function(dataItem, context, recycledMarker) {
						var content = '标注: ' + (context.index + 1) + '',
							label = {
								offset: new AMap.Pixel(16, 18),
								//								content: content
							};

						if(recycledMarker) {
							//存在可回收利用的marker,直接setLabel返回
							recycledMarker.setLabel(label);
							return recycledMarker;
						}
						//返回一个新的Marker
						return new AMap.Marker({
							label: label
						});
					},
					getInfoWindow: function(dataItem, context, recycledInfoWindow) {
						var tpl = '<div class="windowInfo"><div class="infoTitle"><span class="infoWindow-name"><%- dataItem.bootname %></span><span class="infoWindow-name">（<%- dataItem.bootdeviceid %>）</span><select class="<%- dataItem.bootdeviceid %>" style="height:24px;font-size:16px;"><option value="1">1秒</option><option value="5">5秒</option><option value="10">10秒</option><option value="30">30秒</option><option value="60">1分钟</option><option value="120">2分钟</option><option value="300">5分钟</option></select></div><div class="infoWindow-result"><%- dataItem.address %></div><div class="infoWindow-other">(<%- dataItem.onlinestate %> /<%- dataItem.uploadmode %> /<%- dataItem.batteryvoumn %> /<img src="<%- dataItem.signalintensity %>"/>/<%- dataItem.updatetime %>)</div></div>';
						//MarkerList.utils.template支持underscore语法的模板
						var content = MarkerList.utils.template(tpl, {
							dataItem: dataItem,
							dataIndex: context.index
						});
						if(recycledInfoWindow) {
							//存在可回收利用的infoWindow, 直接setContent返回
							recycledInfoWindow.setContent(content);
							return recycledInfoWindow;
						}
						//返回一个新的InfoWindow
						return new AMap.InfoWindow({
							offset: new AMap.Pixel(0, -23),
							content: content
						});
					},
					getListElement: function(dataItem, context, recycledListElement) {
						var tpl = '<div class="info"><div class="infoTitle"><span class="bootname"><%- dataItem.bootname %></span><span class="bootId">（<%- dataItem.bootdeviceid %>）</span></div><div class="result"><%- dataItem.address %></div><div class="infoWindow-other">(<%- dataItem.onlinestate %> /<%- dataItem.uploadmode %> /<%- dataItem.batteryvoumn %> /<img src="<%- dataItem.signalintensity %>"/>/<%- dataItem.updatetime %>)</div></div>';
						var content = MarkerList.utils.template(tpl, {
							dataItem: dataItem,
							dataIndex: context.index
						});
						if(recycledListElement) {
							//存在可回收利用的listElement, 直接更新内容返回
							recycledListElement.innerHTML = content;
							return recycledListElement;
						}
						//返回一段html，MarkerList将利用此html构建一个新的dom节点
						return content;
					}
				});

				//监听选中改变
				markerList.on('selectedChanged', function(event, info) {});

				//监听Marker和ListElement上的点击，详见markerEvents，listElementEvents
				markerList.on('markerClick listElementClick', function(event, record) {});

				//绘制数据源
				markerList.render(arr);

				//全部
				$('#all').on('click', function() {
					$('#getList').html('');
					$(this).addClass('btn-tab-activity');
					$('#onLine').removeClass('btn-tab-activity');
					$('#offLine').removeClass('btn-tab-activity');
					arr = [{
						bootid: '363620181216243',
						bootname: '板鞋',
						stationid: '铁鞋所在站id',
						bootdeviceid: '铁鞋设备id',
						onlinestate: 0,
						uploadmode: 'WIFI',
						batteryvoumn: '95%',
						signalintensity: 1,
						updatetime: '2019-03-17 17:17:53',
						position: [120.618139, 31.300408],
					}, {
						bootid: '363620181216243',
						bootname: '球鞋',
						stationid: '铁鞋所在站id',
						bootdeviceid: '铁鞋设备id',
						onlinestate: 1,
						uploadmode: 'WIFI',
						batteryvoumn: '95%',
						signalintensity: 2,
						updatetime: '2019-03-17 17:17:53',
						position: [120.616897, 31.300689],
					}, {
						bootid: '363620181216243',
						bootname: '草鞋',
						stationid: '铁鞋所在站id',
						bootdeviceid: '铁鞋设备id',
						onlinestate: 0,
						uploadmode: 'WIFI',
						batteryvoumn: '95%',
						signalintensity: 3,
						updatetime: '2019-03-17 17:17:53',
						position: [120.616228, 31.301633],
					}, {
						bootid: '363620181216243',
						bootname: '拖鞋',
						stationid: '铁鞋所在站id',
						bootdeviceid: '铁鞋设备id',
						onlinestate: 1,
						uploadmode: 'WIFI',
						batteryvoumn: '95%',
						signalintensity: 5,
						updatetime: '2019-03-17 17:17:53',
						position: [120.616237, 31.30232],
					}, {
						bootid: '363620181216243',
						bootname: '高跟鞋',
						stationid: '铁鞋所在站id',
						bootdeviceid: '铁鞋设备id',
						onlinestate: 1,
						uploadmode: 'WIFI',
						batteryvoumn: '95%',
						signalintensity: 2,
						updatetime: '2019-03-17 17:17:53',
						position: [120.616188, 31.302815],
					}, {
						bootid: '3636201812162431',
						bootname: '增高鞋',
						stationid: '铁鞋所在站id',
						bootdeviceid: '铁鞋设备id',
						onlinestate: 0,
						uploadmode: 'WIFI',
						batteryvoumn: '95%',
						signalintensity: 4,
						updatetime: '2019-03-17 17:17:53',
						position: [120.61567, 31.302494],
					}, {
						bootid: '3636201812162431',
						bootname: '布鞋',
						stationid: '铁鞋所在站id',
						bootdeviceid: '铁鞋设备id',
						onlinestate: 1,
						uploadmode: 'WIFI',
						batteryvoumn: '95%',
						signalintensity: 1,
						updatetime: '2019-03-17 17:17:53',
						position: [120.615276, 31.301696],
					}, {
						bootid: '1363620181216243',
						bootname: '帆布鞋',
						stationid: '铁鞋所在站id',
						bootdeviceid: '铁鞋设备id',
						onlinestate: 1,
						uploadmode: 'WIFI',
						batteryvoumn: '95%',
						signalintensity: 3,
						updatetime: '2019-03-17 17:17:53',
						position: [120.615171, 31.300674],
					}]
					transform(arr);
					markerList.render(arr);
					$('.amap-ui-markerlist-list-ele').removeClass('info');
				})

				//在线
				$('#onLine').on('click', function() {
					$('#getList').html('');
					$(this).addClass('btn-tab-activity');
					$('#all').removeClass('btn-tab-activity');
					$('#offLine').removeClass('btn-tab-activity');
					arr = [{
						bootid: '363620181216243',
						bootname: '板鞋',
						stationid: '铁鞋所在站id',
						bootdeviceid: '铁鞋设备id',
						onlinestate: 0,
						uploadmode: 'WIFI',
						batteryvoumn: '95%',
						signalintensity: 1,
						updatetime: '2019-03-17 17:17:53',
						position: [120.618139, 31.300408],
						address:'测试'
					}, {
						bootid: '363620181216243',
						bootname: '球鞋',
						stationid: '铁鞋所在站id',
						bootdeviceid: '铁鞋设备id',
						onlinestate: 1,
						uploadmode: 'WIFI',
						batteryvoumn: '95%',
						signalintensity: 2,
						updatetime: '2019-03-17 17:17:53',
						position: [120.616897, 31.300689],
					}, {
						bootid: '363620181216243',
						bootname: '草鞋',
						stationid: '铁鞋所在站id',
						bootdeviceid: '铁鞋设备id',
						onlinestate: 0,
						uploadmode: 'WIFI',
						batteryvoumn: '95%',
						signalintensity: 3,
						updatetime: '2019-03-17 17:17:53',
						position: [120.616228, 31.301633],
					}, {
						bootid: '1363620181216243',
						bootname: '帆布鞋',
						stationid: '铁鞋所在站id',
						bootdeviceid: '铁鞋设备id',
						onlinestate: 1,
						uploadmode: 'WIFI',
						batteryvoumn: '95%',
						signalintensity: 3,
						updatetime: '2019-03-17 17:17:53',
						position: [120.615171, 31.300674],
					}]
					
					transform(arr);
					markerList.render(arr);
					$('.amap-ui-markerlist-list-ele').removeClass('info');
				})

				//离线
				$('#offLine').on('click', function() {
					$('#getList').html('');
					$(this).addClass('btn-tab-activity');
					$('#onLine').removeClass('btn-tab-activity');
					$('#all').removeClass('btn-tab-activity');
					arr = [{
						bootid: '3636201812162431',
						bootname: '布鞋',
						stationid: '铁鞋所在站id',
						bootdeviceid: '铁鞋设备id',
						onlinestate: 1,
						uploadmode: 'WIFI',
						batteryvoumn: '95%',
						signalintensity: 1,
						updatetime: '2019-03-17 17:17:53',
						position: [120.615276, 31.301696],
					}, {
						bootid: '1363620181216243',
						bootname: '帆布鞋',
						stationid: '铁鞋所在站id',
						bootdeviceid: '铁鞋设备id',
						onlinestate: 1,
						uploadmode: 'WIFI',
						batteryvoumn: '95%',
						signalintensity: 3,
						updatetime: '2019-03-17 17:17:53',
						position: [120.615171, 31.300674],
					}]

					transform(arr);
					markerList.render(arr);
					$('.amap-ui-markerlist-list-ele').removeClass('info');
				})

				//搜索
				$('#search').on('click', function() {
					$('#getList').html('');
					$(this).addClass('btn-tab-activity');
					$('#onLine').removeClass('btn-tab-activity');
					$('#all').removeClass('btn-tab-activity');
					arr = [{
						bootid: '363620181216243',
						bootname: '板鞋',
						stationid: '铁鞋所在站id',
						bootdeviceid: '铁鞋设备id',
						onlinestate: 0,
						uploadmode: 'WIFI',
						batteryvoumn: '95%',
						signalintensity: 1,
						updatetime: '2019-03-17 17:17:53',
						position: [120.618139, 31.300408],
					}, {
						bootid: '1363620181216243',
						bootname: '帆布鞋',
						stationid: '铁鞋所在站id',
						bootdeviceid: '铁鞋设备id',
						onlinestate: 1,
						uploadmode: 'WIFI',
						batteryvoumn: '95%',
						signalintensity: 3,
						updatetime: '2019-03-17 17:17:53',
						position: [120.615171, 31.300674],
					}]
					transform(arr);
					markerList.render(arr);
					$('.amap-ui-markerlist-list-ele').removeClass('info');
				})
			}

			//隐藏
			$('.close-icon').on('click', function() {
				$('.infoList').hide();
				$(this).hide();
				$('.show-icon').show();
			})
			//显示
			$('.show-icon').on('click', function() {
				$('.infoList').show();
				$(this).hide();
				$('.close-icon').show();
			})
			//退出登录
			$('#quit').on('click', function() {
				window.location.href = 'login.html';
			})
			
			$('body').on('change','select',function(){
				console.log($(this).val())
			})
			
		</script>
	</body>

</html>